<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.118.2"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.png><link rel=icon type=image/x-icon href=/imgs/icons/favicon.png><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/favicon.png><meta itemprop=name content="GDKOI2021 口胡"><meta itemprop=description content="我是口胡怪。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://myeeye.github.io/imgs/myee.png"><meta itemprop=keywords content="游记,题解,做题记录,图片挂了"><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/font-awesome/6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.css><link rel=stylesheet href=/css/main.min.22062783e6e78c22c1f0ca7e9be14bc728e5cb4329de2bfa71fb454fbdb503d8.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ QwQ ~"}</style><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"GDKOI2021","permalink":"https://myeeye.github.io/post/GDKOI2021/","title":"GDKOI2021 口胡","waline":{"js":[{"alias":"waline","alias_name":"@waline/client","file":"dist/pageview.js","name":"pageview","version":"2.13.0"},{"alias":"waline","alias_name":"@waline/client","file":"dist/comment.js","name":"comment","version":"2.13.0"}]}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>GDKOI2021 口胡 - myee's blog</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>myee's blog</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>And in that light...</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>13</span></a></li><li class="menu-item menu-item-tags"><a href=/tags/ class=hvr-icon-pulse rel=section><i class="fa fa-tag hvr-icon"></i>标签</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-thumbs-up hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-random"><a href=/random.html class=hvr-icon-pulse rel=section><i class="fa fa-random hvr-icon"></i>随机页面</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#day-1>Day 1</a><ul><li><a href=#a>A</a></li><li><a href=#b>B</a></li><li><a href=#c>C</a></li><li><a href=#d>D</a></li></ul></li><li><a href=#day-2>Day 2</a><ul><li><a href=#a-1>A</a></li><li><a href=#b-1>B</a></li><li><a href=#c-1>C</a></li><li><a href=#d-1>D</a></li></ul></li><li><a href=#day-3>Day 3</a><ul><li><a href=#a-2>A</a></li><li><a href=#b-2>B</a></li><li><a href=#c-2>C</a></li><li><a href=#d-2>D</a></li></ul></li></ul></li></ul></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=myee src=/imgs/img-lazy-loading.gif data-src=/imgs/myee.png><p class=site-author-name itemprop=name>myee</p><div class=site-description itemprop=description>QwQ</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>13</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>3</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>6</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=mailto:myeeye@qq.com title="邮箱 → mailto:myeeye@qq.com" rel=noopener target=_blank><i class="fa fa-envelope fa-fw"></i>
邮箱</a></span>
<span class=links-of-social-item><a href=https://www.luogu.com.cn/user/105050 title="洛谷 → https://www.luogu.com.cn/user/105050" rel=noopener target=_blank><i class="fa fa-wifi fa-fw"></i>
洛谷</a></span>
<span class=links-of-social-item><a href=https://github.com/myeeye title="GitHub → https://github.com/myeeye" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>
GitHub</a></span>
<span class=links-of-social-item><a href=https://www.zhihu.com/people/myeeye title="知乎 → https://www.zhihu.com/people/myeeye" rel=noopener target=_blank><i class="fa fa-book fa-fw"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=2022-03-16T15:39:00+08:00></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>总访客数：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>页面浏览：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=33152></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=71></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2023-09-07T17:00:00+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><a role=button class="book-mark-link book-mark-link-fixed"></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://myeeye.github.io/post/GDKOI2021/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/myee.png"><meta itemprop=name content="myee"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="myee"><meta itemprop=description content="QwQ"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="GDKOI2021 口胡"><meta itemprop=description content="我是口胡怪。"></span><header class=post-header><h1 class=post-title itemprop="name headline">GDKOI2021 口胡</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text title=发表于>发表于：</span>
<time title="创建时间：2023-03-12 17:50:00 +0800 CST" itemprop="dateCreated datePublished" datetime="2023-03-12 17:50:00 +0800 CST">2023-03-12</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i></span>
<span class=post-meta-item-text title=更新于>更新于：</span>
<time title=修改时间：2023-03-29T18:30:00+08:00 itemprop=dateModified datetime=2023-03-29T18:30:00+08:00>2023-03-29</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text title=分类于>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E6%B8%B8%E8%AE%B0 itemprop=url rel=index><span itemprop=name>游记</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span>
<span>3915</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>8分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=busuanzi_value_page_pv data-path=/post/GDKOI2021/><i class="fa fa-sync fa-spin"></i></span></span>
<span class=post-meta-item title><span class=post-meta-item-icon><i class="far fa-comments"></i></span>
<span class=post-meta-item-text title=评论>评论：</span>
<span id=comments-count class=waline-comment-count data-path=/post/GDKOI2021/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>因为在广东集训，我们都要参加 GDKOI2023 来试手。</p><p>听说 GDKOI2021 是三天，每天 $4$ 小时 $4$ 题，省选难度，<del>并且没有大样例</del>。<img src=/imgs/img-lazy-loading.gif data-src=https://akioi.xyz:2022/static/img/qq/yun alt=/yun>（p.s. GDKOI2022 未举办）<strong>而且评测机似乎还是 g++ 4.8.4</strong>。<img src=/imgs/img-lazy-loading.gif data-src=https://akioi.xyz:2022/static/img/qq/qd alt=/qd></p><p>然后由于是非正式选手，我们会在纪中机房打，用的机子会统一是只有 g++ 4.9.2 的 Windows 神秘机。<img src=/imgs/img-lazy-loading.gif data-src=https://akioi.xyz:2022/static/img/qq/qd alt=/qd>不过听说评测环境会是 NOI Linux 2.0。</p><p>反正是，纪中教练（Update: 由 Alpha 从教练那边讨来的）给了我们 GDKOI2021 三天的题面，然后手上也没有可以自己交的地方（没有
<a href=https://gmoj.net title=gmoj>gmoj</a> 帐号，注册也没用），因此打算开始口胡！</p><p><a href=/files/GDKOI2021.zip title=题面下载链接>题面下载链接
</a>。</p><h3 id=day-1>Day 1
<a class=header-anchor href=#day-1></a></h3><h4 id=a>A
<a class=header-anchor href=#a></a></h4><blockquote><p>给你一张 $n$ 个点 $m$ 条边的无向图，你要把点集分成两部分，使得两个点集之间的边的边数达到一半的总边数。数据保证有解。</p><p>保证无自环，重边按重数计。</p><p>$n\le10^5$，$m\le2\times10^5$。</p></blockquote><p>考虑对点集增量。</p><p>每增加一个点，考虑其和已有的两个点集中谁的边数更少，加入那个点集即可。</p><p>复杂度 $O(n+m)$。</p><h4 id=b>B
<a class=header-anchor href=#b></a></h4><blockquote><p>给定长为 $n$ 的序列 $a_1,a_2,\cdots,a_n$。</p><p>我们设 $f_{l,r}=(r-l+1)\min_{l\le k\le r}a_k\quad(1\le l\le r\le n)$，求出从小到大排名在 $L$ 到 $R$ 之间的各个 $f$ 值。</p><p>$1\le n\le3\times10^5$，$0\le a_i\le10^9$。</p><p>$1\le L\le R\le n(n+1)/2$，$R-L+1\le3\times10^5$。</p></blockquote><p><del>这个，是不是，可以加进 XJCS，作为单调栈基础练习题啊！@devinwang</del></p><p>写个单调栈，建出笛卡尔树，我们就可以知道对于每个 $\min a$，其向左、向右扩展的距离。</p><p>然后我们考虑二分答案，对每个值 $w$ 查询有多少对 $l,r$ 满足 $f_{l,r}&lt;w$；答案显然不超过 $O(nv)$ 级别，因此只用 $O(\log(nv))$ 轮二分即可解出第 $L$ 大的数对应的权值，以及有多少数小于之。</p><p>然后我们考虑下一个数怎么求：我们先把相同的 $w$ 尽可能取空，这样我们下一个只用考虑 $>w$ 的数。然后我们对每个 $\min a$ 开一个对应了元素的堆，每次取出最小元素后把该 $\min a$ 的下一项放入堆中。</p><p>这样就可以在 $O(n\log(nv))$ 的时间内解决该问题了。</p><h4 id=c>C
<a class=header-anchor href=#c></a></h4><blockquote><p>给定一个长度为 $n$ 的字符串 $s$，$q$ 次询问，回答某个区间 $[l,r]$ 内的<strong>最长回文子串</strong>长度。</p><p>$n,q\le5\times10^5$。时限 $3.5\rm s$。</p></blockquote><p><del>神秘串串题，不会 PAM，爬了爬了。</del></p><p>考虑 manacher，我们对前一半区间考虑，相当于求出区间内 $\min{M_p,p-l}$ 的最大值；后一半同理。</p><p>这个直接离线用扫描线 + 线段树维护哪边取到 $\min$ 即可。在线也可以主席树。</p><p>复杂度 $O((n+q)\log n)$。</p><h4 id=d>D
<a class=header-anchor href=#d></a></h4><blockquote><p>给出 $n,k,A$ 和 $k$ 个数对 $(s_1,v_1)(s_2,v_2)\dots(s_k,v_k)$，求出所有有 $n$ 个叶子的如下二叉树的权值和：</p><ul><li>整颗树的权值定义为其各节点权值之积。</li><li>叶节点权值为 $1$。</li><li>枝节点均有 $2$ 个儿子，且其权值由其左子树中叶子节点个数决定；即，若节点叶子个数为某个 $s_i(1\le i\le k)$ 时，其权值为 $v_i$；如均不满足，则权值定义为 $A$。</li></ul><p>对 $10^9+7$ 取模。</p><p>$1\le n\le10^6$，$0\le k\le10$，$1\le s&lt;n$，$0\le v,A&lt;10^9+7$，$s$ 互不相同。</p></blockquote><p>数数题！</p><p>假设 $n$ 的答案为 $f_n$。</p><p>$$f_n=\begin{cases}1&amp;n=1\newline A\sum_{1\le t\le n-1}f_tf_{n-t}+\sum_p(v_p-A)f_{s_p}f_{n-s_p}&amp;n>1\newline0&\textrm{otherwise.}\end{cases}$$</p><p>先判掉 $A=0$，此时的柿子很简单，直接暴力即是 $O(nk)$ 的。</p><p>剩下的情况乍一眼不可做，因为是半在线卷积形式。</p><p>但这个做法我们感觉很不靠谱，毕竟常数太大了，而 $O(n\log^2n/\log\log n)$ 的也不能用，用了也未必快。</p><p>考虑，设 $h_n=A[\forall t,s_t\neq n]+\sum_t[s_t=n]v_t$，$g_n=h_nf_n$。</p><p>则</p><p>$$f_n=[n=1]+[n>1]\sum_tg_tf_{n-t}$$</p><p>于是设 $F(z)=\sum_nf_nz^n,G(z)=\sum_ng_nz^n$，则</p><p>$$F=z+FG$$</p><p>$$G=AF+\sum_t(v_t-A)z^{s_t}[z^{s_t}]F$$</p><p><strong>我们推回了原式？</strong></p><p>考虑怎么办。</p><p>假设后面的柿子已知，设为 $G=AF+H$。</p><p>则</p><p>$$F=z+AF^2+FH$$</p><p>$$AF^2+(H-1)F+z=0$$</p><p>$$(F+\frac{H-1}{2A})^2=\frac{H^2-2H+1}{4A^2}-\frac zA$$</p><p>$$F=\frac{1-H}{2A}+\sqrt{\frac{H^2-2H+1}{4A^2}-\frac zA}$$</p><p>后面的这个部分就是对一个非 $0$ 项数 $O(k^2)$ 的多项式进行开根。</p><p>这个容易列 ODE，做到 $O(k^2)$ 递推出单项。</p><p>然后就可以通过递推，再反过来对 $H$ 进行增量。</p><p>于是总复杂度即为 $O(nk^2)$。</p><h3 id=day-2>Day 2
<a class=header-anchor href=#day-2></a></h3><h4 id=a-1>A
<a class=header-anchor href=#a-1></a></h4><blockquote><p>初始你有 $0$ 颗星，你将参加若干轮比赛，当你有 $i$ 颗星时胜率为 $p_i$，获胜加 $1$ 颗星，落败减 $1$ 颗星，$0$ 颗星落败不会减星，问期望几轮变为 $n$ 颗星，对 $998244353$ 取模。</p><p>$1\le n\le10^6$，$1\le p_i&lt;998244353$。</p></blockquote><p>设 $f_k$ 表示若初始为 $k$ 颗星，则期望要几轮才可以结束。</p><p>容易发现</p><p>$$f_k=\begin{cases}(1-p_0)f_0+p_0f_1+1&amp;k=0\newline0&amp;k=n\newline(1-p_k)f_{k-1}+p_kf_{k+1}+1&\textrm{otherwise.}\end{cases}$$</p><p>稍作转化，即可依次推出形如 $f_k=f_{k+1}+C_k$ 的柿子，于是就做完了。</p><p>使用离线求逆元，复杂度即为 $O(n+\log{\mathbf{Mod}})$。</p><p>本题亦可以用鞅的停时定理与势函数相关知识解决。</p><h4 id=b-1>B
<a class=header-anchor href=#b-1></a></h4><blockquote><p>给定一张 $n$ 个节点的有向图，每个节点 $p$ 向 $p+1$（如果 $p\neq n$）和 $a_p$ 连出一条边，你要支持 $q$ 次如下操作：</p><ul><li>修改某个 $a_p$。</li><li>查询一个节点 $p$ 可以到达的编号最小节点。</li></ul><p>允许离线。</p><p>$n,q\le10^5$。</p></blockquote><p>唔，很困难啊！</p><p>容易发现 $a_p&lt;p$ 时才有意义，$a_p\ge p$ 相当于没连。</p><p>注意到我们每个节点均可以到达一个后缀，然后这个后缀的起始点是单调的。</p><p>设 $b_p=\max{q|a_q=p}$，如不存在则认为 $b_p=p$。</p><p>考虑如果不带修改，则预处理的部分，可以从小到大依次考虑编号，把 $(p,b_p]$ 的答案均用自己的答案更新。</p><p>如果一个位置 $p$ 不会被任何元素更新，则说明 $\max{b_k|k&lt;p}&lt;p$。</p><p>于是问题就转化为对 $b_p$ 单点修改，查询上一个满足 $\max{b_k|k&lt;p}&lt;p$ 的元素，容易把后面这个东西描述成 $(p,b_p]$ 加 $1$，容易线段树上二分。</p><p>复杂度 $O((n+q)\log n)$。</p><h4 id=c-1>C
<a class=header-anchor href=#c-1></a></h4><blockquote><p>现在有 $26$ 种左右对称的字符，我们不妨称为 $\texttt a\sim\texttt z$，每个字符依次有一个抄写时间 $cost_c$。给你一个长为 $n$ 的字符串，你要<strong>依次</strong>抄写之。</p><p>由于你很聪明，你发现<strong>你可以花 $C$ 的时间把已抄写部分的一个后缀「翻折」到后面的部分，从而避免对那些部分的抄写</strong>（注意最后一个字符可以被往后翻折，也可以直接在此处进行翻折，详见原题面）。</p><p>你要回答至少花多久才可抄完。</p><p>$n\le10^6$，$cost,z\le10^9$。</p></blockquote><p>容易发现对每个前缀，答案是<strong>单调</strong>的；证明比较容易。</p><p>设 $f_n$ 表示对一个长度为 $n$ 的前缀的答案。</p><p>容易发现，我们总是从尽可能早的位置进行翻转（代价都是 $C$ 嘛），或者从上一位的答案直接递推。</p><p>manacher 的同时维护一个单调队列，表示由谁翻转来的贡献即可。</p><p>复杂度 $O(n)$。</p><h4 id=d-1>D
<a class=header-anchor href=#d-1></a></h4><blockquote><p>二叉堆可以通过倒序 $O(n)$ 轮下滤操作构建，代码详见原题面。</p><p>给定一个 $1\sim n$ 的排列 $a$，$q$ 次查询一段区间 $[l,r]$ 如果建出二叉堆，其某个位置 $x$ 的权值，或者某个权值 $x$ 对应的位置。</p><p>$n,q\le10^5$，时限 $2\rm s$。</p></blockquote><p>先看第一类查询。</p><p>当更新到当前点时，其权值为子树中的最大值。</p><p>然后每次看父亲与另一个子树最大值，模拟一下变化即可 $O(\log n)$。</p><p>然后考虑第二类查询。</p><p>我们从此值的位置向上考虑，每次模拟一下操作，即可 $O(\log n)$。</p><p>使用 ST 预处理 RMQ，总复杂度 $O((n+q)\log n)$。</p><p><strong>Update:</strong> 假了，正解是 $2\log$。没事反正口胡。</p><h3 id=day-3>Day 3
<a class=header-anchor href=#day-3></a></h3><h4 id=a-2>A
<a class=header-anchor href=#a-2></a></h4><blockquote><p>给定一颗 $n$ 个节点的树，每个点有点权 $a_i$。</p><p>假设树上有一对路径 $(x,y),(u,v)\quad(x\le y,u\le v)$，设 $f(x,y,u,v)$ 为所有同时在两条路径上的点的点权的 $\operatorname{lcm}$，求出所有 $f(x,y,u,v)$ 的乘积，对 $10^9+7$ 取模。</p><p>$n\le5\times10^5$，$a_i\le5\times10^6$，时限 $2\rm s$。</p></blockquote><p>反向统计有多少路径对会统计到 $p^c$ 的贡献，建出虚树直接计算即可。</p><p>即，点减边容斥，钦定某个点 / 相邻被选点对必定会被选择，求方案数；不被选的点表示其下某些点会和别的某些点匹配。</p><p>容易 $O(\text{点数}\log n)$ 建出虚树并计算贡献。</p><p>由于一个数这样的因子个数为 $O(\log v)$ 的，于是即可 $O(n\log v\log n)$ 解决。</p><p>如果适当地对比较长的部分直接基排，并 ST 表实现 $O(1)$ 查询 LCA，应该可以获得更高效率。</p><h4 id=b-2>B
<a class=header-anchor href=#b-2></a></h4><blockquote><p>给定 $n$ 个数对 $(a_i,b_i)$，一个区间 $[l,r]$ 的正向贡献为 $(\sum_{i=l}^ra_i,\sum_{i=l}^rb_i)$，反向贡献为 $(-\sum_{i=l}^ra_i,-\sum_{i=l}^rb_i)$。</p><p>如果一个贡献的第二部分 $>0$，则称其优秀。</p><p>假设有若干贡献对 $(A,B)$，你要回答对每个 $A$，分别有多少贡献对满足 $B>0$。</p><p>$1\le n\le10^5$，$|a|\le1$，$|b|\le10^9$，时限 $3\rm s$。</p></blockquote><p>不妨分别做前缀和，然后按 $b$ 排序，那么我们发现我们可以把这个按 $b$ 分成若干段，每个元素和之前的段之间的 $a$ 之差有贡献。</p><p>直接分治 FFT 减法卷积计算贡献即可；也可以多叉分治。</p><p>复杂度 $O(n\log^2n)$ 或 $O(n\log^2n/\log\log n)$。</p><p>注意答案可能会很大，要双模 NTT 然后 CRT 合并。</p><p><strong>Update:</strong> 假了，分治下去没有变成更小的问题。正确的做法是分块 FFT。</p><h4 id=c-2>C
<a class=header-anchor href=#c-2></a></h4><blockquote><p>对一个异或生命游戏，初始时有 $n$ 个节点 $(x_1,y_1)(x_2,y_2)\cdots(x_n,y_n)$ 存活，之后某一时刻某节点存活当且仅当上一时刻其四周恰有奇数个节点存活。</p><p>你要回答 $L$ 至 $R$ 时刻存活细胞数目之和，对 $998244353$ 取模。</p><p>$1\le n\le15$，$R\le10^9$，时限 $6\rm s$。</p></blockquote><p>先考虑 $n=1$ 的情形，则一个节点可以在 $t$ 时刻存活当且仅当其有奇数种从起点被走到的方案。</p><p>假设起点 $(0,0)$，终点 $(x,y)$，时间 $t$。</p><p>则存在当且仅当 $|x|+|y|\le t\land2|t-|x|-|y|$。</p><p>方案数则为 $\sum_a\binom{t}{|x|+a,a,(t-|x|+|y|)/2-a,(t-|x|-|y|)/2-a}$。</p><p>化一下柿子。</p><p>$$
\begin{aligned}
&\quad\sum_a\binom{t}{|x|+a,a,(t-|x|+|y|)/2-a,(t-|x|-|y|)/2-a}
\newline&=\binom{t}{(t+|x|+|y|)/2}\sum_a\binom{(t+|x|+|y|)/2}{|x|+a}\binom{(t-|x|-|y|)/2}{a}
\newline&=\binom{t}{(t+|x|+|y|)/2}\binom{t}{(t+|x|-|y|)/2}\quad(\text{范德蒙卷积})
\newline&=\binom{t}{(t+x+y)/2}\binom{t}{(t+x-y)/2}
\end{aligned}
$$</p><p>于是由 Lucas 定理，存活当且仅当 $|x|+|y|\le t$ 且 $2|t-|x|-|y|$ 且 $(t+x+y)/2,(t+x-y)/2$ 均在二进制下为 $t$ 的子集。</p><p>然后就是数个数。</p><p>任取 $t$ 的两个子集 $a,b$ 均可反向唯一确定合法的 $x,y$？</p><p>于是就建立了双射。</p><p>$$x=a+b-t,y=a-b$$</p><p>直接计数 $\sum_{t=L}^{R}4^{\operatorname{popcount}(t)}$ 即可，容易数位 dp 算出每种 $\operatorname{popcount}(t)$ 的方案数，从而做到 $O(\log^2v)$。</p><p>回到原题。</p><p>由于 $n$ 很小，我们考虑容斥掉被多个同时统计的贡献。</p><p>$$x_1+a_1+b_1=x_2+a_2+b_2=\dots=x_n+a_n+b_n$$</p><p>$$y_1+a_1-b_1=y_1+a_1-b_1=\dots=y_n+a_n-b_n$$</p><p>于是一样拆开 $a,b$ 的贡献即可。</p><p>$$(x_1+y_1)/2+a_1=(x_2+y_2)/2+a_2=\dots=(x_n+y_n)/2+a_n$$</p><p>$$(x_1-y_1)/2+b_1=(x_2-y_2)/2+b_2=\dots=(x_n-y_n)/2+b_n$$</p><p>（注意可能带一个 $1/2$，但奇偶性必须相同）</p><p>按 $x+y$ 排序，则合法 $a$ 递减。</p><p>然后枚举最小 $a$，可以推出其余 $a$ 与之的差量。</p><p>感觉能数位 dp，但是没推过，咕了。</p><h4 id=d-2>D
<a class=header-anchor href=#d-2></a></h4><p>没看。睡觉去了。明天 GDKOI Day 2 RP++。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/%e6%b8%b8%e8%ae%b0>游记</a>
<a href=/tags/%e9%a2%98%e8%a7%a3>题解</a>
<a href=/tags/%e5%81%9a%e9%a2%98%e8%ae%b0%e5%bd%95>做题记录</a>
<a href=/tags/%e5%9b%be%e7%89%87%e6%8c%82%e4%ba%86>图片挂了</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
GDKOI2021 口胡</li><li class=post-copyright-author><strong>本文作者：</strong>
myee</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://myeeye.github.io/post/GDKOI2021/ title="GDKOI2021 口胡">https://myeeye.github.io/post/GDKOI2021/</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/post/GDKOI2023/ rel=next title="GDKOI2023 游记"><i class="fa fa-chevron-left"></i> GDKOI2023 游记</a></div><div class="post-nav-prev post-nav-item"><a href=/post/USACO2023Feb/ rel=prev title="USACO2023Feb 游记">USACO2023Feb 游记
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>myee</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.118.2 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.5.3 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div></div></footer><script type=text/javascript src=https://cdn.staticfile.org/animejs/3.2.1/anime.min.js defer></script>
<script type=text/javascript src=https://cdn.staticfile.org/viewerjs/1.11.0/viewer.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#e0e1cc","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"hostname":"https://myeeye.github.io/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"qiniu","router":"https://cdn.staticfile.org"},"version":"4.5.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o / 国内可能无法正常使用 waline 评论，请谅解","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://waline-f6vrtotj0-myeeye.vercel.app/","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.13.0"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.13.0"}}}</script><script type=text/javascript src=/js/main.min.42f3b58a368bcbc725e767168f07e54e4815106000c302667d825806716e3ae0.js defer></script></body></html>